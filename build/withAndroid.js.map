{"version":3,"file":"withAndroid.js","sourceRoot":"","sources":["../src/withAndroid.ts"],"names":[],"mappings":";;;AAAA,yDAM8B;AAC9B,gFAA8E;AAEvE,MAAM,mBAAmB,GAAiB,CAAC,MAAM,EAAE,EAAE;IAC1D,OAAO,IAAA,qCAAoB,EAAC,MAAM,EAAE,CAAC,MAAM,EAAE,EAAE;QAC7C,qBAAqB;QACrB,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;YACrB,IAAI,EAAE,UAAU;YAChB,GAAG,EAAE,uBAAuB;YAC5B,KAAK,EAAE,OAAO;SACf,CAAC,CAAC;QAEH,wBAAwB;QACxB,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;YACrB,IAAI,EAAE,UAAU;YAChB,GAAG,EAAE,qCAAqC;YAC1C,KAAK,EAAE,qBAAqB;SAC7B,CAAC,CAAC;QAEH,OAAO,MAAM,CAAC;IAChB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAlBW,QAAA,mBAAmB,uBAkB9B;AAEK,MAAM,yBAAyB,GAAiB,CAAC,MAAM,EAAE,EAAE;IAChE,OAAO,IAAA,oCAAmB,EAAC,MAAM,EAAE,CAAC,MAAM,EAAE,EAAE;QAC5C,MAAM,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAA,4BAAa,EAAC;YACzC,GAAG,EAAE,qBAAqB;YAC1B,GAAG,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;YAC/B,MAAM,EAAE;;;OAGP;YACD,MAAM,EAAE,mCAAmC;YAC3C,iCAAiC;YACjC,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,IAAI;SACd,CAAC,CAAC,QAAQ,CAAC;QAEZ,MAAM,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAA,4BAAa,EAAC;YACzC,GAAG,EAAE,uBAAuB;YAC5B,GAAG,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;YAC/B,MAAM,EAAE;;;;;OAKP;YACD,MAAM,EAAE,6CAA6C;YACrD,iCAAiC;YACjC,MAAM,EAAE,CAAC,CAAC;YACV,OAAO,EAAE,IAAI;SACd,CAAC,CAAC,QAAQ,CAAC;QAEZ,OAAO,MAAM,CAAC;IAChB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAhCW,QAAA,yBAAyB,6BAgCpC;AAEK,MAAM,iBAAiB,GAAiB,CAAC,MAAM,EAAE,EAAE;IACxD,OAAO,IAAA,mCAAkB,EAAC,MAAM,EAAE,CAAC,MAAM,EAAE,EAAE;QAC3C,MAAM,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAA,4BAAa,EAAC;YACzC,GAAG,EAAE,cAAc;YACnB,GAAG,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;YAC/B,MAAM,EAAE;;OAEP;YACD,MAAM,EAAE,wBAAwB;YAChC,iCAAiC;YACjC,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,IAAI;SACd,CAAC,CAAC,QAAQ,CAAC;QAEZ,OAAO,MAAM,CAAC;IAChB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAhBW,QAAA,iBAAiB,qBAgB5B;AAEK,MAAM,iBAAiB,GAAiB,CAAC,MAAM,EAAE,EAAE;IACxD,OAAO,IAAA,mCAAkB,EAAC,MAAM,EAAE,CAAC,MAAM,EAAE,EAAE;QAC3C,MAAM,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAA,4BAAa,EAAC;YACzC,GAAG,EAAE,cAAc;YACnB,GAAG,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;YAC/B,MAAM,EAAE;;;OAGP;YACD,MAAM,EAAE,gBAAgB;YACxB,MAAM,EAAE,CAAC,CAAC;YACV,OAAO,EAAE,IAAI;SACd,CAAC,CAAC,QAAQ,CAAC;QAEZ,OAAO,MAAM,CAAC;IAChB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAhBW,QAAA,iBAAiB,qBAgB5B","sourcesContent":["import {\n  ConfigPlugin,\n  withAppBuildGradle,\n  withGradleProperties,\n  withMainApplication,\n  withSettingsGradle,\n} from \"@expo/config-plugins\";\nimport { mergeContents } from \"@expo/config-plugins/build/utils/generateCode\";\n\nexport const setGradleProperties: ConfigPlugin = (config) => {\n  return withGradleProperties(config, (config) => {\n    // Set kotlin version\n    config.modResults.push({\n      type: \"property\",\n      key: \"android.kotlinVersion\",\n      value: \"1.6.0\",\n    });\n\n    // Set packaging options\n    config.modResults.push({\n      type: \"property\",\n      key: \"android.packagingOptions.pickFirsts\",\n      value: \"**/libc++_shared.so\",\n    });\n\n    return config;\n  });\n};\n\nexport const setAndroidMainApplication: ConfigPlugin = (config) => {\n  return withMainApplication(config, (config) => {\n    config.modResults.contents = mergeContents({\n      tag: \"watermelondb-import\",\n      src: config.modResults.contents,\n      newSrc: `\n        import com.nozbe.watermelondb.jsi.WatermelonDBJSIPackage;\n        import com.facebook.react.bridge.JSIModulePackage;\n      `,\n      anchor: /import android\\.app\\.Application;/,\n      // Inside the dependencies block.\n      offset: 1,\n      comment: \"//\",\n    }).contents;\n\n    config.modResults.contents = mergeContents({\n      tag: \"watermelondb-function\",\n      src: config.modResults.contents,\n      newSrc: `\n        @Override\n        protected JSIModulePackage getJSIModulePackage() {\n          return new WatermelonDBJSIPackage();\n        }      \n      `,\n      anchor: /protected String getJSMainModuleName\\(\\) \\{/,\n      // Inside the dependencies block.\n      offset: -2,\n      comment: \"//\",\n    }).contents;\n\n    return config;\n  });\n};\n\nexport const setAppBuildGradle: ConfigPlugin = (config) => {\n  return withAppBuildGradle(config, (config) => {\n    config.modResults.contents = mergeContents({\n      tag: \"watermelondb\",\n      src: config.modResults.contents,\n      newSrc: `\n        implementation project(':watermelondb-jsi')\n      `,\n      anchor: /dependencies(?:\\s+)?\\{/,\n      // Inside the dependencies block.\n      offset: 1,\n      comment: \"//\",\n    }).contents;\n\n    return config;\n  });\n};\n\nexport const setSettingsGradle: ConfigPlugin = (config) => {\n  return withSettingsGradle(config, (config) => {\n    config.modResults.contents = mergeContents({\n      tag: \"watermelondb\",\n      src: config.modResults.contents,\n      newSrc: `        \n        include ':watermelondb-jsi'\n        project(':watermelondb-jsi').projectDir = new File(rootProject.projectDir, '../node_modules/@nozbe/watermelondb/native/android-jsi')\n      `,\n      anchor: /include ':app'/,\n      offset: -1,\n      comment: \"//\",\n    }).contents;\n\n    return config;\n  });\n};\n"]}